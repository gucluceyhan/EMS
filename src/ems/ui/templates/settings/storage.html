{% extends "base.html" %}

{% block title %}Data Storage - GES Solar EMS{% endblock %}

{% block page_subtitle %}Data Storage Settings{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 py-6 space-y-6">
  <h1 class="text-xl font-semibold">Settings â€“ Data Storage</h1>
  
  <div class="bg-white dark:bg-gray-950 border border-gray-200 dark:border-gray-800 rounded-xl p-4">
    <div class="flex items-center justify-between mb-3">
      <h2 class="font-semibold">Local Storage Configuration</h2>
      <div class="space-x-2">
        <button id="btnTestStorage" class="px-3 py-2 rounded-md border border-gray-200 dark:border-gray-700">Test DB</button>
        <button id="btnOptimizeDb" class="px-3 py-2 rounded-md border border-gray-200 dark:border-gray-700">Optimize</button>
      </div>
    </div>
    
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <h3 class="font-medium mb-2">SQLite Database</h3>
        <div class="space-y-3">
          <label class="text-sm">Database Path<input id="dbPath" value="data/ems.sqlite" class="w-full bg-transparent border border-gray-200 dark:border-gray-700 rounded-md px-3 py-2" /></label>
          <label class="text-sm">Retention Days<input id="retentionDays" value="30" type="number" class="w-full bg-transparent border border-gray-200 dark:border-gray-700 rounded-md px-3 py-2" /></label>
          <label class="text-sm">WAL Mode<select id="walMode" class="w-full bg-transparent border border-gray-200 dark:border-gray-700 rounded-md px-3 py-2"><option>WAL</option><option>DELETE</option><option>TRUNCATE</option></select></label>
          <label class="text-sm">Vacuum Interval (hours)<input id="vacuumInterval" value="24" type="number" class="w-full bg-transparent border border-gray-200 dark:border-gray-700 rounded-md px-3 py-2" /></label>
        </div>
      </div>
      
      <div>
        <h3 class="font-medium mb-2">Parquet Export</h3>
        <div class="space-y-3">
          <label class="text-sm">Export Directory<input id="exportDir" value="data/exports" class="w-full bg-transparent border border-gray-200 dark:border-gray-700 rounded-md px-3 py-2" /></label>
          <label class="text-sm">Export Interval (hours)<input id="exportInterval" value="1" type="number" class="w-full bg-transparent border border-gray-200 dark:border-gray-700 rounded-md px-3 py-2" /></label>
          <label class="text-sm">Compression<select id="parquetCompression" class="w-full bg-transparent border border-gray-200 dark:border-gray-700 rounded-md px-3 py-2"><option>snappy</option><option>gzip</option><option>lz4</option><option>brotli</option></select></label>
          <label class="flex items-center gap-2 text-sm">
            <input id="enableParquetExport" type="checkbox" />
            Enable Parquet Export
          </label>
        </div>
      </div>
    </div>
  </div>

  <!-- Storage Statistics -->
  <div class="bg-white dark:bg-gray-950 border border-gray-200 dark:border-gray-800 rounded-xl p-4">
    <h2 class="font-semibold mb-3">Storage Statistics</h2>
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
      <div class="text-center p-3 border border-gray-200 dark:border-gray-800 rounded-md">
        <div class="text-xs text-gray-500">Database Size</div>
        <div class="text-lg font-semibold">245 MB</div>
      </div>
      <div class="text-center p-3 border border-gray-200 dark:border-gray-800 rounded-md">
        <div class="text-xs text-gray-500">Total Records</div>
        <div class="text-lg font-semibold">1.2M</div>
      </div>
      <div class="text-center p-3 border border-gray-200 dark:border-gray-800 rounded-md">
        <div class="text-xs text-gray-500">Disk Usage</div>
        <div class="text-lg font-semibold">42%</div>
      </div>
      <div class="text-center p-3 border border-gray-200 dark:border-gray-800 rounded-md">
        <div class="text-xs text-gray-500">Available Space</div>
        <div class="text-lg font-semibold">28.5 GB</div>
      </div>
    </div>
  </div>

  <!-- Backup Configuration -->
  <div class="bg-white dark:bg-gray-950 border border-gray-200 dark:border-gray-800 rounded-xl p-4">
    <h2 class="font-semibold mb-3">Backup Configuration</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <label class="text-sm">Backup Schedule<select id="backupSchedule" class="w-full bg-transparent border border-gray-200 dark:border-gray-700 rounded-md px-3 py-2"><option>Daily</option><option>Weekly</option><option>Monthly</option><option>Disabled</option></select></label>
      <label class="text-sm">Backup Retention (days)<input id="backupRetention" value="7" type="number" class="w-full bg-transparent border border-gray-200 dark:border-gray-700 rounded-md px-3 py-2" /></label>
      <label class="text-sm">Remote Backup URL<input id="remoteBackupUrl" placeholder="sftp://backup.example.com" class="w-full bg-transparent border border-gray-200 dark:border-gray-700 rounded-md px-3 py-2" /></label>
      <label class="flex items-center gap-2 text-sm">
        <input id="enableRemoteBackup" type="checkbox" />
        Enable Remote Backup
      </label>
    </div>
  </div>

  <div class="flex items-center gap-2">
    <button id="btnSaveStorage" class="px-3 py-2 rounded-md bg-brand-600 text-white">Save Storage Settings</button>
    <button id="btnResetStorage" class="px-3 py-2 rounded-md border border-gray-200 dark:border-gray-700">Reset</button>
    <button id="btnBackupNow" class="px-3 py-2 rounded-md bg-blue-600 text-white">Backup Now</button>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  // Storage settings specific JavaScript
  document.addEventListener('DOMContentLoaded', () => {
    // Initialize storage settings UI
  });
</script>
{% endblock %}